
@{
    ViewData["Title"] = "Reporte Excel";

    var hoy = DateTime.Today;
    var haceUnMes = hoy.AddMonths(-1);
    
    var mesActual = hoy.Month;
    var yearActual = hoy.Year;
    
    var mesAnterior = haceUnMes.Month;
    var yearAnteriorYear = haceUnMes.Year;

    var yearAnterior = yearActual - 1;
}

<partial name="_SubMenu" model="SubMenuTransacciones.Excel" />

<h1>Exportar Transacciones a Excel</h1>
<div class="mb-3">
    <a asp-action="ExportarExcelPorMes" 
    asp-route-mes="@mesActual" 
    asp-route-year="@yearActual"
    class="btn btn-success">
        Exportar mes actual
    </a> - @hoy.ToString("MMMM yyyy")
</div>

<div class="mb-3">
    <a asp-action="ExportarExcelPorMes"
       asp-route-mes="@mesAnterior"
       asp-route-year="@yearAnteriorYear"
       class="btn btn-success">
        Exportar mes anterior
    </a> - @haceUnMes.ToString("MMMM yyyy")
</div>

<div class="mb-3">
    <a asp-action="ExportarExcelPorYear"
       asp-route-year="@yearActual"
       class="btn btn-success">
        Exportar year actual
    </a> - @yearActual
</div>

<div class="mb-3">
    <a asp-action="ExportarExcelPorYear"
       asp-route-year="@yearAnterior"
       class="btn btn-success">
        Exportar year anterior
    </a> - @yearAnterior
</div>

<div class="mb-3">
    <a asp-action="ExportarExcelTodo"
       class="btn btn-success">
        Exportar Todo
    </a>
</div>